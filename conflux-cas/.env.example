# =============================================================================
# conflux-cas — Environment Variables
# Copy to .env and fill in values. Never commit .env.
# =============================================================================

# ------------------------------------------------------------------ Backend --
# Path to SQLite database file
DATABASE_PATH=./data/cas.db

# JWT signing secret (run: openssl rand -hex 32)
JWT_SECRET=replace_with_a_32_byte_random_hex_string

# Express server port
PORT=3001

# Allowed CORS origins (comma-separated for multiple)
CORS_ORIGIN=http://localhost:3000

# ------------------------------------------------------------------ Worker ---
# Private key of the executor/keeper wallet (include the 0x prefix)
# This wallet calls executeJob on AutomationManager – it does NOT custody tokens.
EXECUTOR_PRIVATE_KEY=replace_with_0x_prefixed_64_hex_chars

# Conflux eSpace RPC endpoints
CONFLUX_ESPACE_TESTNET_RPC=https://evmtestnet.confluxrpc.com
CONFLUX_ESPACE_MAINNET_RPC=https://evm.confluxrpc.com

# Target network: "testnet" | "mainnet"
NETWORK=testnet

# Worker poll interval in milliseconds (default: 15000)
WORKER_POLL_INTERVAL_MS=15000

# Maximum gas price gwei before worker halts (circuit breaker)
MAX_GAS_PRICE_GWEI=1000

# Job poll batch size
JOB_BATCH_SIZE=50

# Audit log file path
AUDIT_LOG_PATH=./logs/audit.jsonl

# --------------------------------------------------------------- Contracts ---
# Contract addresses for the active network.
# These are emitted by `pnpm contracts:deploy` and also tracked in
# conflux-contracts/deployments.json. After a new deploy, copy the
# printed values here.
#
# Testnet (chain 71):
# AUTOMATION_MANAGER_ADDRESS=0x33e5e5b262e5d8ebc443e1c6c9f14215b020554d
# PRICE_ADAPTER_ADDRESS=0x88c48e0e8f76493bb926131a2be779cc17ecbedf
# PERMIT_HANDLER_ADDRESS=0x4240882f2d9d70cdb9fbcc859cdd4d3e59f5d137
#
# Mainnet (chain 1030):
# AUTOMATION_MANAGER_ADDRESS=0x9D5B131e5bA37A238cd1C485E2D9d7c2A68E1d0F
# PRICE_ADAPTER_ADDRESS=0xD2Cc2a7Eb4A5792cE6383CcD0f789C1A9c48ECf9
# PERMIT_HANDLER_ADDRESS=0x0D566aC9Dd1e20Fc63990bEEf6e8abBA876c896B
AUTOMATION_MANAGER_ADDRESS=0x0000000000000000000000000000000000000000
PRICE_ADAPTER_ADDRESS=0x0000000000000000000000000000000000000000
PERMIT_HANDLER_ADDRESS=0x0000000000000000000000000000000000000000

# NOTE: DEPLOYER_PRIVATE_KEY and CONFLUXSCAN_API_KEY belong in the root
# /repos/.env — they are used by the Hardhat / deploy toolchain, not the app.

# ---------------------------------------------------------------- Frontend --
# Backend URL for Next.js server-side API proxy (next.config.cjs rewrites)
# Leave blank for local dev (defaults to http://localhost:3001)
BACKEND_URL=http://localhost:3001

# WalletConnect project ID (get one at https://cloud.walletconnect.com)
NEXT_PUBLIC_WC_PROJECT_ID=replace_with_walletconnect_project_id

# Backend API base URL (no trailing slash)
NEXT_PUBLIC_API_URL=http://localhost:3001

# Target chain: "testnet" | "mainnet"
NEXT_PUBLIC_NETWORK=testnet

# AutomationManager address (same as AUTOMATION_MANAGER_ADDRESS above, exposed to browser)
NEXT_PUBLIC_AUTOMATION_MANAGER_ADDRESS=0x0000000000000000000000000000000000000000

# --------------------------------------------------------- Pools / RPC tuning --
# How many RPC calls to send per sequential chunk (each chunk = 1 HTTP batch request).
# Lower this if you see "Request exceeds defined limit" errors. Default: 10
POOLS_CHUNK_SIZE=10

# Milliseconds to wait between sequential chunks.
# Increase on heavily rate-limited networks. Default: 150
POOLS_CHUNK_DELAY_MS=150

# viem batchSize: max JSON-RPC calls coalesced into one HTTP request.
# Must be ≤ the node's per-request limit. Default: 20
POOLS_BATCH_SIZE=20

# viem batch coalescing window in ms — how long viem waits to accumulate calls
# before firing a batch. Default: 16
POOLS_BATCH_WAIT_MS=16

# Pool metadata cache TTL in ms (default: 1800000 = 30 minutes).
POOLS_CACHE_TTL_MS=1800000

# -------------------------------------------------- Admin / Access Control --
# Comma-separated Ethereum addresses allowed to call admin endpoints
# (pause/resume worker) and see the Safety panel. Case-insensitive.
# Example: ADMIN_ADDRESSES=0xAbc...,0xDef...
ADMIN_ADDRESSES=

# Same list exposed to the browser so the frontend can hide the Safety link.
NEXT_PUBLIC_ADMIN_ADDRESSES=
